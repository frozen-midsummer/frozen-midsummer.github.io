import{g as X,u as Z,h as I,i as ee,j as se,t as te,k as le,l as Q,m as B,n as t,p as ae,q as U,s as ie,R as F,v as re,x as ue,y as ne,z as oe,A as ve,B as $,C as M,D as ce,E as de,G as me,H as he,I as pe,J as ye,K as Ee,L as _,M as ge,N as j}from"./app-DYAirNoF.js";const we=["/","/algorithm/","/database/","/devtools/","/dotnet/","/htmlcss/","/javainterviewexp/JUC%20_%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html","/javainterviewexp/JVM.html","/javainterviewexp/Java.html","/javainterviewexp/Linux%20_%20Git.html","/javainterviewexp/Mysql.html","/javainterviewexp/","/javainterviewexp/Redis.html","/javainterviewexp/hrinterview.html","/javainterviewexp/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html","/javainterviewexp/%E6%A1%86%E6%9E%B6.html","/javainterviewexp/%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E9%97%AE%E9%A2%98.html","/javainterviewexp/%E7%AE%97%E6%B3%95.html","/javainterviewexp/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html","/javainterviewexp/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html","/javainterviewexp/%E9%A1%B9%E7%9B%AE.html","/javascript/","/os/","/python/","/serverside/","/websiteconstruction/","/database/mysql/","/database/sql/","/devtools/git/","/devtools/littletools/","/devtools/markdown/","/devtools/maven/","/devtools/pnpm/","/devtools/superresolution/","/javascript/projectconstruct/","/javascript/vuejs/","/os/linux/","/os/wine/","/serverside/designmodel/","/serverside/docker/","/serverside/pythonlearning/README1.html","/serverside/redis/","/serverside/regularexpression/","/websiteconstruction/githubpages/","/websiteconstruction/vuepresslearning/","/serverside/designmodel/dddlearning/","/serverside/designmodel/dddlearning/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1.html","/serverside/designmodel/factorymodel/","/serverside/javalearning/mapstruct/","/serverside/javalearning/maven/","/serverside/javalearning/plantuml/","/404.html"],xe="SLIMSEARCH_QUERY_HISTORY",y=_(xe,[]),Ae=()=>{const{queryHistoryCount:a}=j;return{enabled:a>0,queryHistories:y,addQueryHistory:u=>{y.value=Array.from(new Set([u,...y.value.slice(0,a-1)]))},removeQueryHistory:u=>{y.value=[...y.value.slice(0,u),...y.value.slice(u+1)]}}},D=a=>we[a.id]+("anchor"in a?`#${a.anchor}`:""),Be="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:T}=j,E=_(Be,[]),je=()=>({enabled:T>0,resultHistories:E,addResultHistory:r=>{{const u={link:D(r),display:r.display};"header"in r&&(u.header=r.header),E.value=[u,...E.value.slice(0,T-1)]}},removeResultHistory:r=>{E.value=[...E.value.slice(0,r),...E.value.slice(r+1)]}}),fe=a=>{const r=ce(),u=I(),f=de(),n=Q(0),g=B(()=>n.value>0),c=me([]);return he(()=>{const{search:H,terminate:m}=pe(),w=ye(h=>{const{resultsFilter:R=l=>l,querySplitter:p,suggestionsFilter:S,...i}=r.value;h?(n.value+=1,H(h,u.value,i).then(l=>R(l,h,u.value,f.value)).then(l=>{n.value-=1,c.value=l}).catch(l=>{console.warn(l),n.value-=1,n.value||(c.value=[])})):c.value=[]},j.searchDelay-j.suggestDelay,{maxWait:5e3});U([a,u],([h])=>{w(h.join(" "))},{immediate:!0}),Ee(()=>{m()})}),{isSearching:g,results:c}};var Re=X({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:r}){const u=Z(),f=I(),n=ee(se),{addQueryHistory:g,queryHistories:c,removeQueryHistory:H}=Ae(),{resultHistories:m,addResultHistory:w,removeResultHistory:h}=je(),R=te(a,"queries"),{results:p,isSearching:S}=fe(R),i=le({isQuery:!0,index:0}),l=Q(0),d=Q(0),L=B(()=>c.value.length>0||m.value.length>0),k=B(()=>p.value.length>0),C=B(()=>p.value[l.value]||null),J=()=>{const{isQuery:e,index:s}=i;s===0?(i.isQuery=!e,i.index=e?m.value.length-1:c.value.length-1):i.index=s-1},O=()=>{const{isQuery:e,index:s}=i;s===(e?c.value.length-1:m.value.length-1)?(i.isQuery=!e,i.index=0):i.index=s+1},P=()=>{l.value=l.value>0?l.value-1:p.value.length-1,d.value=C.value.contents.length-1},Y=()=>{l.value=l.value<p.value.length-1?l.value+1:0,d.value=0},G=()=>{d.value<C.value.contents.length-1?d.value+=1:Y()},V=()=>{d.value>0?d.value-=1:P()},q=e=>e.map(s=>ge(s)?s:t(s[0],s[1])),z=e=>{if(e.type==="customField"){const s=oe[e.index]||"$content",[o,A=""]=ve(s)?s[f.value].split("$content"):s.split("$content");return e.display.map(v=>t("div",q([o,...v,A])))}return e.display.map(s=>t("div",q(s)))},x=()=>{l.value=0,d.value=0,r("updateQuery",""),r("close")},K=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},n.value.queryHistory),c.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:i.isQuery&&i.index===s}],onClick:()=>{r("updateQuery",e)}},[t($,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:M,onClick:o=>{o.preventDefault(),o.stopPropagation(),H(s)}})]))])),N=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},n.value.resultHistory),m.value.map((e,s)=>t(F,{to:e.link,class:["slimsearch-result-item",{active:!i.isQuery&&i.index===s}],onClick:()=>{x()}},()=>[t($,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(o=>q(o)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:M,onClick:o=>{o.preventDefault(),o.stopPropagation(),h(s)}})]))]));return ae("keydown",e=>{if(a.isFocusing){if(k.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const s=C.value.contents[d.value];g(a.queries.join(" ")),w(s),u.push(D(s)),x()}}else if(e.key==="ArrowUp")J();else if(e.key==="ArrowDown")O();else if(e.key==="Enter"){const{index:s}=i;i.isQuery?(r("updateQuery",c.value[s]),e.preventDefault()):(u.push(m.value[s].link),x())}}}),U([l,d],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!k.value:!L.value}],id:"slimsearch-results"},a.queries.length?S.value?t(ie,{hint:n.value.searching}):k.value?t("ul",{class:"slimsearch-result-list"},p.value.map(({title:e,contents:s},o)=>{const A=l.value===o;return t("li",{class:["slimsearch-result-list-item",{active:A}]},[t("div",{class:"slimsearch-result-title"},e||n.value.defaultTitle),s.map((v,W)=>{const b=A&&d.value===W;return t(F,{to:D(v),class:["slimsearch-result-item",{active:b,"aria-selected":b}],onClick:()=>{g(a.queries.join(" ")),w(v),x()}},()=>[v.type==="text"?null:t(v.type==="title"?re:v.type==="heading"?ue:ne,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[v.type==="text"&&v.header?t("div",{class:"content-header"},v.header):null,t("div",z(v))])])})])})):n.value.emptyResult:L.value?[K(),N()]:n.value.emptyHistory)}});export{Re as default};
